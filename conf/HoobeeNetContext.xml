<?xml version="1.0" encoding="UTF-8"?>
<!--
<!DOCTYPE beans PUBLIC "-//SPRING//DTD BEAN//EN"
"http://www.springframework.org/dtd/spring-beans.dtd">
-->
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="  http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd" default-lazy-init="true">
	
	<!-- PMF Bean -->
	<!--bean id="pmf" class="org.springframework.orm.jdo.LocalPersistenceManagerFactoryBean">
		<property name="jdoProperties">
			<props>
				<prop key="javax.jdo.PersistenceManagerFactoryClass"> org.datanucleus.jdo.JDOPersistenceManagerFactory</prop>
				
				<prop key="javax.jdo.option.ConnectionURL">jdbc:h2:~/db/database</prop>
				<prop key="javax.jdo.option.ConnectionDriverName">org.h2.Driver</prop>
				
				<prop key="javax.jdo.option.ConnectionUserName">codeshelf</prop>
				<prop key="javax.jdo.option.ConnectionPassword">codeshelf</prop>
				<prop key="javax.jdo.option.DetachAllOnCommit">true</prop>
				<prop key="javax.jdo.option.NontransactionalRead">true</prop>
				<prop key="javax.jdo.option.RetainValues">true</prop>
				<prop key="javax.jdo.option.CopyOnAttach">true</prop>
				<prop key="javax.jdo.mapping.Schema">CODESHELF</prop>
				<prop key="datanucleus.storeManagerType">rdbms</prop>
				<prop key="datanucleus.autoCreateSchema">true</prop>
				<prop key="datanucleus.autoCreateTables">true</prop>
				<prop key="datanucleus.autoCreateConstraints">true</prop>
				<prop key="datanucleus.autoCreateColumns">true</prop>
				<prop key="datanucleus.validateTables">true</prop>
				<prop key="datanucleus.validateConstraints">true</prop>
				<prop key="datanucleus.validateColumns">true</prop>
				<prop key="datanucleus.identifierFactory">jpox2</prop>
				<prop key="datanucleus.autoStartClassNames">com.gadgetworks.codeshelf.model.domain.Account, com.gadgetworks.codeshelf.model.domain.Person</prop>
				<prop key="datanucleus.maxFetchDepth">-1</prop>
				<prop key="datanucleus.rdbms.sql.allowAllSQLStatements">true</prop>
				<prop key="datanucleus.query.flushBeforeExecution">true</prop>
				<prop key="datanucleus.cache.collections">true</prop>
				<prop key="datanucleus.cache.collections.lazy">true</prop>
				<prop key="datanucleus.persistenceByReachabilityAtCommit">false</prop>
				<!-/-prop key="datanucleus.connectionPoolingType">none</prop>
				<prop key="datanucleus.connectionPoolingConfigurationFile">C3P0.properties</prop-/->
				<prop key="datanucleus.rdbms.datastoreAdapterClassName">com.gadgetworks.codeshelf.model.dao.GWDerbyAdapter</prop>
				<prop key="datanucleus.cache.level1.type">hard</prop>
				<prop key="datanucleus.cache.level2">true</prop>
				<prop key="datanucleus.cache.level2.type">soft</prop>
				<prop key="datanucleus.attachSameDatastore">true</prop>
			</props>
		</property>
	</bean-->
	
	<!-- DataNucleus Dialect overriding default Spring handling -->
	<!--bean id="dataNucleusDialect" class="org.datanucleus.springframework.DataNucleusJdoDialect">
	</bean-->
	
	<!-- Transaction manager for a single DataNucleus PMF -->
	<!--bean id="transactionManager" class="org.springframework.orm.jdo.JdoTransactionManager">
		<property name="persistenceManagerFactory">
			<ref local="pmf"/>
		</property>
		<property name="jdoDialect">
			<ref local="dataNucleusDialect"/>
		</property>
	</bean-->
	
	<!-- CodeShelf primary DAO -->
	<bean id="systemDAO" class="com.gadgetworks.codeshelf.model.dao.SystemDAO">
		<!--property name="persistenceManagerFactory">
			<ref local="pmf"/>
		</property-->
	</bean>
	
	<!-- Transactional proxy for the primary DAO -->
	<!--bean id="codeshelfWrappedDAO" class="org.springframework.transaction.interceptor.TransactionProxyFactoryBean">
		<property name="transactionManager">
			<ref local="transactionManager"/>
		</property>
		<property name="target">
			<ref local="systemDAO"/>
		</property>
		<property name="transactionAttributes">
			<props>
				<!-/-prop key="get*">PROPAGATION_SUPPORTS,readOnly</prop-/->
				<prop key="find*">PROPAGATION_SUPPORTS,readOnly</prop>
				<!-/-prop key="is*">PROPAGATION_SUPPORTS,readOnly</prop-/->
				<prop key="load*">PROPAGATION_SUPPORTS,readOnly</prop>
				<!-/-prop key="push*">PROPAGATION_SUPPORTS,readOnly</prop-/->
				<prop key="store*">PROPAGATION_NESTED</prop>
				<prop key="delete*">PROPAGATION_NESTED</prop>
			</props>
		</property>
	</bean-->
	
	<!-- Controller -->
	<bean id="ToyController" class="com.gadgetworks.flyweightcontroller.controller.toy.ToyController" scope="singleton">
		<constructor-arg>
			<list>
				<ref bean="VirtualInterface"/>
				<ref bean="SerialInterface"/>
			</list>
		</constructor-arg>
	</bean>
	
	<bean id="SerialInterface" class="com.gadgetworks.flyweightcontroller.controller.FTDIInterface" scope="singleton"></bean>
	<bean id="VirtualInterface" class="com.gadgetworks.codeshelf.model.VirtualRocketPhoneInterface" scope="singleton"></bean>

</beans>